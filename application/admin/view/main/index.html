<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>聊之旅后台管理</title>
    <link rel="stylesheet" href="/wetour/public/static/css/layui.css">
    <script src="/wetour/public/static/layui.js"></script>
    <script src="/wetour/public/static/js/echarts.min.js"></script>
    <script src="/wetour/public/static/js/jquery-3.4.1.min.js"></script>
    <script src="/wetour/public/static/js/city.js"></script>
    <style>
        body {
            user-select: none;
        }

        .layui-tab {
            height: calc(100% - 20px);
            width: 100%;
        }

        .layui-tab-content {
            height: 100%;
        }

        .layui-tab-item {
            width: 100%;
            height: 100%;
        }

        a {
            cursor: pointer;
        }
    </style>
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">聊之旅后台管理</div>
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item"><a href="">控制台</a></li>
            <li class="layui-nav-item"><a href="">商品管理</a></li>
            <li class="layui-nav-item"><a href="">用户</a></li>
            <li class="layui-nav-item">
                <a href="javascript:;">其它系统</a>
                <dl class="layui-nav-child">
                    <dd><a href="">邮件管理</a></dd>
                    <dd><a href="">消息管理</a></dd>
                    <dd><a href="">授权管理</a></dd>
                </dl>
            </li>
        </ul>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;">
                    <img src="/wetour/public/static/images/face/0.gif" class="layui-nav-img">
                    {$user}
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="">基本资料</a></dd>
                    <dd><a href="">安全设置</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item"><a href="/wetour/public/admin/login">推出</a></li>
        </ul>
    </div>
    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <ul class="layui-nav layui-nav-tree" lay-filter="test">
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">导航管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="11" data-url="/wetour/public/admin/nav/openinsert"><a target="right">添加导航</a></dd>
                        <dd data-id="12" data-url="/wetour/public/admin/nav/index"><a target="tight">查看导航</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">分类管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="21" data-url="/wetour/public/admin/category/openinsert"><a target="right">添加分类</a>
                        </dd>
                        <dd data-id="22" data-url="/wetour/public/admin/category/index"><a target="tight">查看分类</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">商品管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="31" data-url="/wetour/public/admin/goods/openinsert"><a target="right">添加商品</a>
                        </dd>
                        <dd data-id="32" data-url="/wetour/public/admin/goods/index"><a target="tight">查看商品</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">预约管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="41" data-url="/wetour/public/admin/onlinebooking/openinsert"><a
                                target="right">添加预约</a></dd>
                        <dd data-id="42" data-url="/wetour/public/admin/onlinebooking/index"><a target="tight">查看预约</a>
                        </dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">新闻管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="51" data-url="/wetour/public/admin/news/openinsert"><a target="right">添加新闻</a></dd>
                        <dd data-id="52" data-url="/wetour/public/admin/news/index"><a target="tight">查看新闻</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">服务项目管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="61" data-url="/wetour/public/admin/service/openinsert"><a target="right">添加服务</a>
                        </dd>
                        <dd data-id="62" data-url="/wetour/public/admin/service/index"><a target="tight">查看服务</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">公司介绍管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="71" data-url="/wetour/public/admin/company/openinsert"><a target="right">添加介绍</a>
                        </dd>
                        <dd data-id="72" data-url="/wetour/public/admin/company/index"><a target="tight">查看介绍</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">导游管理</a>
                    <dl class="layui-nav-child">
                        <dd data-id="81" data-url="/wetour/public/admin/aboutus/openinsert"><a target="right">添加导游</a>
                        </dd>
                        <dd data-id="82" data-url="/wetour/public/admin/aboutus/index"><a target="tight">查看导游</a></dd>
                    </dl>
                </li>
            </ul>
        </div>
    </div>

    <div class="layui-body">
        <!-- 内容主体区域 -->
        <div style="padding: 15px;height: 100%;box-sizing: border-box;">
            <div class="layui-tab" lay-filter="demo" lay-allowclose="true">
                <ul class="layui-tab-title">
                    <li lay-id="000">门票分析</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <div id="main" style="width: 1200px;height:400px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-footer">
    </div>
</div>
<script type="text/javascript">
    let myChart = echarts.init(document.getElementById('main'));
    let data = genData();
    // option = {
    //     title: {
    //         text: '门票各地销售统计',
    //         x: 'center'
    //     },
    //     tooltip: {
    //         trigger: 'item',
    //         formatter: "{a} <br/>{b} : {c} ({d}%)"
    //     },
    //     legend: {
    //         type: 'scroll',
    //         orient: 'vertical',
    //         right: 10,
    //         top: 20,
    //         bottom: 20,
    //         data: data.legendData,
    //         selected: data.selected
    //     },
    //     series: [
    //         {
    //             barWidth: '60%',
    //             name: '姓名',
    //             type: 'pie',
    //             radius: '55%',
    //             center: ['40%', '50%'],
    //             data: data.seriesData,
    //             // itemStyle: {
    //             //     emphasis: {
    //             //         shadowBlur: 10,
    //             //         shadowOffsetX: 0,
    //             //         shadowColor: 'rgba(0, 0, 0, 0.5)'
    //             //     }
    //             // }
    //         }
    //     ]
    // };

    function genData() {
        let legendData = [];
        let seriesData = [];
        let selected = {};
        let names = [];
        for (let i in arrCity) {
            names.push(arrCity[i].name);
            seriesData.push({
                name: arrCity[i].name,
                value: Math.round(Math.random() * 10000)
            });
        }
        console.log(selected);
        return {
            legendData: names,
            seriesData: seriesData,
            selected: selected
        };
    }

    option = {
        color: ['#c23531','#2f4554', '#61a0a8', '#d48265', '#91c7ae','#749f83',],
        tooltip: {
            trigger: 'axis',
            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
        grid: {
            left: '1%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: [
            {
                type: 'category',
                data: data.legendData,
                axisTick: {
                    alignWithLabel: true,
                    interval:0,
                },
            },
        ],
        yAxis: [
            {
                type: 'value',
            }
        ],
        series: [
            {
                name: '销售量',
                type: 'bar',
                barWidth: '60%',
                data: data.seriesData,
                label: {
                    normal: {
                        show: true,
                        position: 'inside',
                    },
                },
            },
        ],
    };
    myChart.setOption(option);
</script>
<script>
    layui.use(['element'], function () {
        let $ = layui.jquery, element = layui.element;
        $('dd').on('click', function () {
            let id = this.dataset.id;
            //$(this).data('id');
            let tittle = $(this).children('a').text();
            // $('a',this).text();//效果同上
            let arr = $('li[lay-id]');
            let flag = false;
            let ele = arr.map(function (index, element) {
                return element.getAttribute('lay-id');
            });
            // flag=Array.from(ele).some(ele=>ele==id);
            flag = Array.prototype.some.call(ele, ele => ele == id);
            if (flag) {
                element.tabChange('demo', id);
            } else {
                let urls = this.dataset.url;
                element.tabAdd('demo', {
                    title: tittle,
                    content: `
                        <iframe src="${urls}" frameborder="0" style="width: 100%;height: 100%;"></iframe>
                    `,
                    id: id
                });
                element.tabChange('demo', id);
            }
        });
    });
</script>
</body>
</html>